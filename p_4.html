<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MKX: 4 MKX API</title>
<link rel="icon" type="image/x-icon" href="mkx.svg">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo">
    <img alt="Logo" src="mkx.svg" style="height: 60px; padding: 10px;"/>
  </td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MKX
   &#160;<span id="projectnumber">v1.0.0</span>
   </div>
   <div id="projectbrief">Next Generation Mechanical Keyboard Firmware</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('p_4.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">4 MKX API</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#p_4_1">4.1 Boot Config</a></li>
<li class="level1"><a href="#p_4_2">4.2 HID</a><ul><li class="level2"><a href="#p_4_2_1">4.2.1 HID_USB</a></li>
<li class="level2"><a href="#p_4_2_2">4.2.2 HID_BLE</a></li>
</ul>
</li>
<li class="level1"><a href="#p_4_3">4.3 MKX Central</a><ul><li class="level2"><a href="#p_4_3_1">4.3.1 add_central_periphery</a></li>
<li class="level2"><a href="#p_4_3_2">4.3.2 add_interface</a></li>
<li class="level2"><a href="#p_4_3_3">4.3.3 add_layer_status_led</a></li>
<li class="level2"><a href="#p_4_3_4">4.3.4 add_backlight</a></li>
<li class="level2"><a href="#p_4_3_5">4.3.5 add_keymap</a></li>
<li class="level2"><a href="#p_4_3_6">4.3.6 run_forever</a></li>
</ul>
</li>
<li class="level1"><a href="#p_4_4">4.4 MKX Periphery</a><ul><li class="level2"><a href="#p_4_4_1">4.4.1 PeripheryCentral</a></li>
<li class="level2"><a href="#p_4_4_2">4.4.2 PeripheryUART</a></li>
</ul>
</li>
<li class="level1"><a href="#p_4_5">4.5 Interface</a><ul><li class="level2"><a href="#p_4_5_1">4.5.1 InterphaceCentral</a></li>
<li class="level2"><a href="#p_4_5_2">4.5.2 InterphaceUART</a></li>
</ul>
</li>
<li class="level1"><a href="#p_4_6">4.6 Layer Status LED</a><ul><li class="level2"><a href="#p_4_6_1">4.6.1 LayerStatusLedRgbNeoPixel</a></li>
<li class="level2"><a href="#p_4_6_2">4.6.2 LayerStatusLedRgbThreePin</a></li>
<li class="level2"><a href="#p_4_6_3">4.6.3 LayerStatusLedArray</a></li>
</ul>
</li>
<li class="level1"><a href="#p_4_7">4.7 Backlight</a><ul><li class="level2"><a href="#p_4_7_1">4.7.1 BacklightNeopixelStatic</a></li>
<li class="level2"><a href="#p_4_7_2">4.7.2 BacklightNeopixelRainbow</a></li>
<li class="level2"><a href="#p_4_7_2_1">4.7.2.1 faster()</a></li>
<li class="level2"><a href="#p_4_7_2_2">4.7.2.2 slower()</a></li>
<li class="level2"><a href="#p_4_7_2_3">4.7.2.3 set_swirl()</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="p_4_1"></a>
4.1 Boot Config</h1>
<p>The <b>boot_cfg</b> function can be used in <b>boot.py</b>, which should be placed in the root directory of your CircuitPython device, alongside <b>code.py</b> or <b>main.py</b>. <br  />
</p>
<p><b>boot.py</b> runs only once at startup, before any workflows are initialized. This allows you to configure USB and other settings dynamically at startup, rather than relying on fixed defaults. <br  />
 Because the serial console is not yet available, output is written to <b>boot_out.txt</b>. For a more detailed explanation, see the <a href="https://docs.circuitpython.org/en/latest/README.html">CircuitPython Documentation</a>. <br  />
</p>
<p>If an error occurs during startup, the device should fall back to a mountable and debuggable configuration. <br  />
</p>
<p>⚠️️ <b>Warning:</b> <em>Always back up your code before disabling the storage feature. In critical scenarios incorrect pin configuration or other errors can make the board unresponsive. <br  />
 In such cases, a hard reset may be required, which erases all data and necessitates re-uploading your code.</em></p>
<div class="fragment"><div class="line"><span class="comment"># boot.py</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">import</span> board</div>
<div class="line"> </div>
<div class="line"><span class="keyword">from</span> mkx.boot_config <span class="keyword">import</span> boot_cfg</div>
<div class="line"> </div>
<div class="line">boot_cfg(</div>
<div class="line">    sense,</div>
<div class="line">    source=<span class="keywordtype">None</span>,</div>
<div class="line">    autoreload: bool = <span class="keyword">True</span>,</div>
<div class="line">    boot_device: int = 0,</div>
<div class="line">    cdc: bool = <span class="keyword">True</span>,</div>
<div class="line">    consumer_control: bool = <span class="keyword">True</span>,</div>
<div class="line">    keyboard: bool = <span class="keyword">True</span>,</div>
<div class="line">    midi: bool = <span class="keyword">True</span>,</div>
<div class="line">    mouse: bool = <span class="keyword">True</span>,</div>
<div class="line">    nkro: bool = <span class="keyword">False</span>,</div>
<div class="line">    pan: bool = <span class="keyword">False</span>,</div>
<div class="line">    storage: bool = <span class="keyword">True</span>,</div>
<div class="line">    usb_id: tuple[str, str] = <span class="keywordtype">None</span>,</div>
<div class="line">    **kwargs,</div>
<div class="line">) -&gt; bool:</div>
</div><!-- fragment --><p><b>sense</b> <br  />
 <code>sense</code> accepts either uninitialized <code>microcontroller.Pin</code>, or <code>digitalio.DigitalInOut</code>. The boot configuration is only applied if <code>sense</code> reads <code>True</code> or "high", and skipped if it reads <code>False</code> or "low". If <code>sense</code> is an uninitialized <code>Pin</code>, it'll be configured as pulled-up input; it wont be further configured if it is a <code>DigitalInOut</code>.</p>
<p><b>source</b> <br  />
 <code>source</code> accepts either uninitialized <code>microcontroller.Pin</code>, <code>digitalio.DigitalInOut</code>, or <code>None</code>. It's the "source" of the test voltage to be read by the sense pin. If <code>source</code> is an uninitialized <code>Pin</code>, it'll be configured as a "low" output; it wont be further configured if it is a <code>DigitalInOut</code>.</p>
<p>Common matrix and direct pin configurations (see also the examples below):</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">diode_orientation   </th><th class="markdownTableHeadNone">sense pin   </th><th class="markdownTableHeadNone">source pin    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>COL2ROW</code>   </td><td class="markdownTableBodyNone">column   </td><td class="markdownTableBodyNone">row    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>ROW2COL</code>   </td><td class="markdownTableBodyNone">row   </td><td class="markdownTableBodyNone">column    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">direct pin   </td><td class="markdownTableBodyNone">direct pin   </td><td class="markdownTableBodyNone"><code>None</code>   </td></tr>
</table>
<p><b>autoreload</b> <br  />
 By default, CircuitPython automatically reloads whenever files are saved (and sometimes unexpectedly due to board glitches). <br  />
 This behavior is useful during development, allowing you to see changes immediately. <br  />
 For everyday use, it’s recommended to disable autoreload to improve stability. <br  />
</p>
<p><b>boot_device</b> <br  />
 Boot HID device configuration for <code>usb_hid</code>, see the <a href="https://docs.circuitpython.org/en/latest/shared-bindings/usb_hid/index.html#usb_hid.enable"><code>usb_hid</code> documentation</a> for details.</p>
<p><b>cdc</b> <br  />
 Enables or disables the USB endpoint that provides the CircuitPython serial console (REPL), allowing or preventing access to the interactive prompt over USB.</p>
<p><b>consumer_control</b> <br  />
 Enable the HID endpoint for consumer control reports. Those are extra keys for things like multimedia control and browser shortcuts.</p>
<p><b>keyboard</b> <br  />
 Enable the keyboard HID endpoint. <br  />
</p>
<p><b>midi</b> <br  />
 Enable MIDI over USB. Enabled by default in CircuitPython, but most keyboards don't use it.</p>
<p><b>mouse</b> <br  />
 Enables the HID USB endpoint for a pointing device. Unlike a keyboard, a mouse provides continuous input along multiple axes, allowing movement in all directions rather than discrete key presses.</p>
<p><b>nkro</b> <br  />
 Enables N-key rollover support. When the default keyboard is active, this replaces the standard 6-key rollover endpoint with an N-key rollover endpoint. <br  />
 This is not a standard HID feature, so it’s intended for advanced users who understand the implications.</p>
<p><b>pan</b> <br  />
 Enables horizontal scrolling (panning) for the HID pointing device (mouse) endpoint.</p>
<p><b>storage</b> <br  />
 Disables USB storage to prevent your computer from automatically recognizing the device as a new removable drive when the keyboard is connected. <br  />
 Preventing the board from appearing as a mass storage device, may be important for cybersecurity policies in some workplaces.</p>
<p><b>usb_id</b> <br  />
 Introduced in CircuitPython 8, this allows you to customize your keyboard’s USB identity instead of using the default “MCU board manufacturer – CircuitPython device.”</p>
<p><b>return value</b> <br  />
 <em>boot_cfg</em> returns <b>True</b> if the boot configuration was applied successfully, and <b>False</b> if it was skipped. <br  />
 This allows the sense pin mechanism to be reused for other custom boot configurations. <br  />
 Any unexpected errors are not caught intentionally, so they are recorded in <b>boot_out.txt</b> to facilitate debugging. <br  />
</p>
<p><b>Example:</b> </p><div class="fragment"><div class="line"><span class="comment"># boot.py</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">import</span> board</div>
<div class="line"> </div>
<div class="line"><span class="keyword">from</span> mkx.boot_config <span class="keyword">import</span> boot_cfg</div>
<div class="line"> </div>
<div class="line">boot_cfg(</div>
<div class="line">    sense=board.D13,  <span class="comment"># column</span></div>
<div class="line">    source=board.D5,  <span class="comment"># row</span></div>
<div class="line">    autoreload=<span class="keyword">False</span>,</div>
<div class="line">    storage=<span class="keyword">False</span>,</div>
<div class="line">    usb_id=(<span class="stringliteral">&quot;MKX Device&quot;</span>, <span class="stringliteral">&quot;Sq Keyboard&quot;</span>),</div>
<div class="line">)</div>
</div><!-- fragment --><h1><a class="anchor" id="p_4_2"></a>
4.2 HID</h1>
<p>Type of HID device to use. <br  />
 Possible options are <b>HID_USB</b> for a standard USB HID device or <b>HID_BLE</b> for a Bluetooth Low Energy HID device. <br  />
</p>
<h2><a class="anchor" id="p_4_2_1"></a>
4.2.1 HID_USB</h2>
<p>Set USB HID device.</p>
<p><b>Example:</b> </p><div class="fragment"><div class="line"><span class="keyword">from</span> mkx.hid_usb <span class="keyword">import</span> HID_USB</div>
<div class="line"> </div>
<div class="line">hid = HID_USB()</div>
<div class="line">keyboard.set_hid(hid) <span class="comment"># TO DO</span></div>
</div><!-- fragment --><h2><a class="anchor" id="p_4_2_2"></a>
4.2.2 HID_BLE</h2>
<p>Set BLE HID device.</p>
<p><b>Example:</b> </p><div class="fragment"><div class="line"><span class="keyword">from</span> mkx.hid_ble <span class="keyword">import</span> HID_BLE</div>
<div class="line"> </div>
<div class="line">hid = HID_BLE()</div>
<div class="line">keyboard.set_hid(hid) <span class="comment"># TO DO</span></div>
</div><!-- fragment --><h1><a class="anchor" id="p_4_3"></a>
4.3 MKX Central</h1>
<p>Main <b>MKX</b> class that manages keyboard operation and handles communication with the computer. <br  />
</p>
<div class="fragment"><div class="line"><span class="keyword">from</span> mkx.mkx_central <span class="keyword">import</span> MKX_Central</div>
<div class="line"> </div>
<div class="line">MKX_Central(</div>
<div class="line">    keymap=<span class="keywordtype">None</span>, </div>
<div class="line">    coord_mapping=<span class="keywordtype">None</span></div>
<div class="line">)</div>
</div><!-- fragment --><p><b>keymap</b> <br  />
 Add <em>keymap</em> object to the <b>MKX_Central</b>. May be also added later with the <b>add_keymap()</b> method.</p>
<p><b>coord_mapping</b> <br  />
 Add custom <em>coord_mapping</em> object to the <b>MKX_Central</b>. <br  />
 Usualy coord_mapping is defined while <b>MKX Interpfaces</b> declaration. <br  />
 May be also added later with the <b>add_coord_mapping()</b> method. # TO DO</p>
<p><b>Example:</b> </p><div class="fragment"><div class="line"><span class="keyword">from</span> mkx.mkx_central <span class="keyword">import</span> MKX_Central</div>
<div class="line"> </div>
<div class="line">mkx_central = MKX_Central()</div>
</div><!-- fragment --><h2><a class="anchor" id="p_4_3_1"></a>
4.3.1 add_central_periphery</h2>
<p>Add <b>PeripheryCentral</b> to the ***MKX_Central**. <br  />
</p>
<div class="fragment"><div class="line">mkx_central.add_central_periphery(</div>
<div class="line">    central_periphery: PeripheryAbstract</div>
<div class="line">)</div>
</div><!-- fragment --><p><b>central_periphery</b> <br  />
 <em>PeripheryCentral</em> object.</p>
<p><b>Example:</b> </p><div class="fragment"><div class="line"><span class="keyword">from</span> mkx.mkx_central <span class="keyword">import</span> MKX_Central</div>
<div class="line"><span class="keyword">from</span> mkx.periphery_central <span class="keyword">import</span> PeripheryCentral</div>
<div class="line"> </div>
<div class="line">mkx_central = MKX_Central()</div>
<div class="line"> </div>
<div class="line">central_peryphery = PeripheryCentral(<span class="stringliteral">&quot;central&quot;</span>, col_pins, row_pins)</div>
<div class="line">mkx_central.add_central_periphery(central_peryphery)</div>
</div><!-- fragment --><h2><a class="anchor" id="p_4_3_2"></a>
4.3.2 add_interface</h2>
<p>Add <b>Interface</b> of a <b>Periphery</b> to the <b>MKX_Central</b>. <br  />
</p>
<div class="fragment"><div class="line">mkx_central.add_interface(</div>
<div class="line">    interface: InterfahceAbstract</div>
<div class="line">)</div>
</div><!-- fragment --><p><b>interface</b> <br  />
 <em>Interface</em> object.</p>
<p><b>Example:</b> </p><div class="fragment"><div class="line"><span class="keyword">from</span> mkx.mkx_central <span class="keyword">import</span> MKX_Central</div>
<div class="line"><span class="keyword">from</span> mkx.periphery_central <span class="keyword">import</span> PeripheryCentral</div>
<div class="line"><span class="keyword">from</span> mkx.interphace_central <span class="keyword">import</span> InterphaceCentral</div>
<div class="line"><span class="keyword">from</span> mkx.interphace_uart <span class="keyword">import</span> InterphaceUART</div>
<div class="line"> </div>
<div class="line">mkx_central = MKX_Central()</div>
<div class="line"> </div>
<div class="line">central_peryphery = PeripheryCentral(<span class="stringliteral">&quot;central&quot;</span>, col_pins, row_pins)</div>
<div class="line"> </div>
<div class="line">interphace_central = InterphaceCentral(central_peryphery, 0, 0, 5, 4)</div>
<div class="line">keyboard.add_interface(interphace_central)</div>
<div class="line"> </div>
<div class="line">interphace_right = InterphaceUART(<span class="stringliteral">&quot;right_peryphery&quot;</span>, <span class="keywordtype">None</span>, board.GP1, 11, 0, 6, 4)</div>
<div class="line">keyboard.add_interface(interphace_right)</div>
</div><!-- fragment --><h2><a class="anchor" id="p_4_3_3"></a>
4.3.3 add_layer_status_led</h2>
<p>Add <b>LayerStatusLed</b> to the <b>MKX_Central</b>. <br  />
</p>
<div class="fragment"><div class="line">mkx_central.add_layer_status_led(</div>
<div class="line">    status_led: LayerStatusLedAbstract</div>
<div class="line">)</div>
</div><!-- fragment --><p><b>status_led</b> <br  />
 <em>LayerStatusLed</em> object.</p>
<p><b>Example:</b> <br  />
 </p><div class="fragment"><div class="line"><span class="keyword">import</span> board</div>
<div class="line"> </div>
<div class="line"><span class="keyword">from</span> mkx.mkx_central <span class="keyword">import</span> MKX_Central</div>
<div class="line"><span class="keyword">from</span> mkx.layer_status_led_rgb_neopixel <span class="keyword">import</span> LayerStatusLedRgbNeoPixel</div>
<div class="line"> </div>
<div class="line">mkx_central = MKX_Central()</div>
<div class="line"> </div>
<div class="line">status_led = LayerStatusLedRgbNeoPixel(board.SCK)</div>
<div class="line">status_led.add_layer(0, (0, 0, 255))  <span class="comment"># Blue</span></div>
<div class="line">status_led.add_layer(1, (0, 255, 0))  <span class="comment"># Green</span></div>
<div class="line">status_led.add_layer(2, (255, 255, 255))  <span class="comment"># White</span></div>
<div class="line">status_led.add_layer(3, (255, 0, 0))  <span class="comment"># Red</span></div>
<div class="line">mkx_central.add_layer_status_led(status_led)</div>
</div><!-- fragment --><h2><a class="anchor" id="p_4_3_4"></a>
4.3.4 add_backlight</h2>
<p>Add <b>Backlight</b> to the <b>MKX_Central</b>. <br  />
</p>
<div class="fragment"><div class="line">mkx_central.add_backlight(</div>
<div class="line">    backlight: BacklightAbstract</div>
<div class="line">)</div>
</div><!-- fragment --><p><b>backlight</b> <br  />
 <em>Backlight</em> object.</p>
<p><b>Example:</b> <br  />
 </p><div class="fragment"><div class="line"><span class="keyword">import</span> board</div>
<div class="line"> </div>
<div class="line"><span class="keyword">from</span> mkx.mkx_central <span class="keyword">import</span> MKX_Central</div>
<div class="line"><span class="keyword">from</span> mkx.backlight_neopixel_rainbow <span class="keyword">import</span> BacklightNeopixelRainbow</div>
<div class="line"> </div>
<div class="line">mkx_central = MKX_Central()</div>
<div class="line"> </div>
<div class="line">backlight = BacklightNeopixelRainbow(board.A0, num_pixels=72, brightness=0.4)</div>
<div class="line">backlight.slower(2)</div>
<div class="line">backlight.set_swirl(<span class="keyword">True</span>)</div>
<div class="line">mkx_central.add_backlight(backlight)</div>
</div><!-- fragment --><h2><a class="anchor" id="p_4_3_5"></a>
4.3.5 add_keymap</h2>
<p>Add <b>Keymap</b> to the <b>MKX_Central</b>. <br  />
 <b>Keymap</b> must have rectangular shape. In custom layouts where certain positions are unused, set them to <b>None</b>.</p>
<div class="fragment"><div class="line">mkx_central.add_keymap(</div>
<div class="line">    keymap, </div>
<div class="line">    col_size, </div>
<div class="line">    row_size</div>
<div class="line">)</div>
</div><!-- fragment --><p><b>keymap</b> <br  />
 <em>Keymap</em> object.</p>
<p><b>col_size</b> <br  />
 Keymap layer max column number. <br  />
 Counting starts from '0'. <br  />
</p>
<p><b>row_size</b> <br  />
 Keymap layer max row number. <br  />
 Counting starts from '0'. <br  />
</p>
<p><b>Example:</b> <br  />
 </p><div class="fragment"><div class="line"><span class="keyword">from</span> mkx.mkx_central <span class="keyword">import</span> MKX_Centrals</div>
<div class="line"> </div>
<div class="line"><span class="keyword">from</span> mkx.keys_standard <span class="keyword">import</span> *</div>
<div class="line"> </div>
<div class="line">mkx_central = MKX_Central()</div>
<div class="line"> </div>
<div class="line"><span class="comment"># fmt: off</span></div>
<div class="line"> </div>
<div class="line">keymap = [</div>
<div class="line">    [</div>
<div class="line">        A,  B,  C,</div>
<div class="line">        N1, N2, <span class="keywordtype">None</span>,</div>
<div class="line">    ],</div>
<div class="line">]</div>
<div class="line"> </div>
<div class="line"><span class="comment"># fmt: on</span></div>
<div class="line"> </div>
<div class="line">mkx_central.add_keymap(keymap, 2, 1)</div>
</div><!-- fragment --><h2><a class="anchor" id="p_4_3_6"></a>
4.3.6 run_forever</h2>
<p>Start runninhg keyboard's infinite loop.</p>
<div class="fragment"><div class="line">mkx_central.run_forever()</div>
</div><!-- fragment --><h1><a class="anchor" id="p_4_4"></a>
4.4 MKX Periphery</h1>
<p>The general <b>Periphery</b> captures keystrokes and transmit messages to the <b>MKX_Central</b>. <br  />
 The <b>MKX_Periphery</b> is a simpler counterpart to the <b>MKX_Central</b>, <br  />
 operating continuously on hardware separate from the <b>MKX_Central</b>. <br  />
 Each <b>MKX_Periphery</b> is assigned a general <b>Periphery</b>.</p>
<p>The general <b>Periphery</b> can be implemented as <b>PeripheryCentral</b>, which operates on the same hardware module as the Central, <br  />
 or as <b>PeripheryUART</b>, on a separate hardware module and communicates via UART. <br  />
</p>
<div class="fragment"><div class="line"><span class="keyword">from</span> mkx.mkx_periphery <span class="keyword">import</span> MKX_Periphery</div>
<div class="line"> </div>
<div class="line">mkx_perifery = MKX_Periphery(</div>
<div class="line">    uart_peryphery: PeripheryAbstract, </div>
<div class="line">    debug :bool=<span class="keyword">False</span></div>
<div class="line">)</div>
</div><!-- fragment --><p><b>uart_peryphery</b> <br  />
 PeripheryUART object (or other derived from the <em>PeripheryAbstract</em>). <br  />
</p>
<p><b>debug</b> <br  />
 Flag enabling verbose output for the Periphery. <br  />
</p>
<h2><a class="anchor" id="p_4_4_1"></a>
4.4.1 PeripheryCentral</h2>
<p>Set the PeripheryCentral.</p>
<div class="fragment"><div class="line"><span class="keyword">from</span> mkx.periphery_central <span class="keyword">import</span> PeripheryCentral</div>
<div class="line"> </div>
<div class="line">mkx_perifery = PeripheryCentral(</div>
<div class="line">    device_id: str, </div>
<div class="line">    col_pins, </div>
<div class="line">    row_pins, </div>
<div class="line">    **kwargs</div>
<div class="line">)</div>
</div><!-- fragment --><p><b>device_id</b> <br  />
 Device id/name. <br  />
</p>
<p><b>col_pins</b> <br  />
 List of column pins. <br  />
</p>
<p><b>row_pins</b> <br  />
 List of row pins. <br  />
</p>
<p>** <b>kwargs</b> <br  />
 Other optional arguments. <br  />
</p>
<p><b>Example:</b> </p><div class="fragment"><div class="line"><span class="keyword">import</span> board</div>
<div class="line"> </div>
<div class="line"><span class="keyword">from</span> mkx.mkx_central <span class="keyword">import</span> MKX_Central</div>
<div class="line"><span class="keyword">from</span> mkx.periphery_central <span class="keyword">import</span> PeripheryCentral</div>
<div class="line"><span class="keyword">from</span> mkx.interphace_central <span class="keyword">import</span> InterphaceCentral</div>
<div class="line"><span class="keyword">from</span> mkx.interphace_uart <span class="keyword">import</span> InterphaceUART</div>
<div class="line"> </div>
<div class="line">mkx_central = MKX_Central()</div>
<div class="line"> </div>
<div class="line">col_pins = (board.GP9, board.GP7, board.GP5, board.GP4, board.GP3, board.GP2)</div>
<div class="line">row_pins = (board.GP10, board.GP11, board.GP13, board.GP15, board.GP17)</div>
<div class="line"> </div>
<div class="line">central_peryphery = PeripheryCentral(<span class="stringliteral">&quot;central_peryphery&quot;</span>, col_pins, row_pins)</div>
<div class="line">mkx_central.add_central_periphery(central_peryphery)</div>
<div class="line"> </div>
<div class="line">interphace_central = InterphaceCentral(central_peryphery, 0, 0, 5, 4)</div>
<div class="line">mkx_central.add_interface(interphace_central)</div>
<div class="line"> </div>
<div class="line">interphace_right = InterphaceUART(<span class="stringliteral">&quot;side_perifery&quot;</span>, <span class="keywordtype">None</span>, board.GP1, 11, 0, 6, 4)</div>
<div class="line">mkx_central.add_interface(interphace_right)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># other code ...</span></div>
<div class="line"> </div>
<div class="line">mkx_central.run_forever()</div>
</div><!-- fragment --><h2><a class="anchor" id="p_4_4_2"></a>
4.4.2 PeripheryUART</h2>
<p>Set the PeripheryUART.</p>
<div class="fragment"><div class="line"><span class="keyword">from</span> mkx.periphery_uart <span class="keyword">import</span> PeripheryUART</div>
<div class="line"> </div>
<div class="line">mkx_perifery = PeripheryUART(</div>
<div class="line">    device_id: str, </div>
<div class="line">    col_pins, </div>
<div class="line">    row_pins, </div>
<div class="line">    tx_pin,</div>
<div class="line">    rx_pin,</div>
<div class="line">    *,</div>
<div class="line">    baudrate=9600,</div>
<div class="line">    **kwargs</div>
<div class="line">)</div>
</div><!-- fragment --><p><b>device_id</b> <br  />
 Device id/name. <br  />
</p>
<p><b>col_pins</b> <br  />
 List of column pins. <br  />
</p>
<p><b>row_pins</b> <br  />
 List of row pins. <br  />
</p>
<p><b>tx_pin</b> <br  />
 TX communication pin. <br  />
</p>
<p><b>rx_pin</b> <br  />
 RX communication pin. <br  />
</p>
<p><b>baudrate</b> <br  />
 UART communication baudrate. <br  />
</p>
<p>** <b>kwargs</b> <br  />
 Other optional arguments. <br  />
</p>
<p><b>Example:</b> </p><div class="fragment"><div class="line"><span class="keyword">import</span> board</div>
<div class="line"> </div>
<div class="line"><span class="keyword">from</span> mkx.mkx_periphery <span class="keyword">import</span> MKX_Periphery</div>
<div class="line"><span class="keyword">from</span> mkx.periphery_uart <span class="keyword">import</span> PeripheryUART</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">col_pins = (board.GP9, board.GP7, board.GP5, board.GP4, board.GP3, board.GP2)</div>
<div class="line">row_pins = (board.GP10, board.GP11, board.GP13, board.GP15, board.GP17)</div>
<div class="line"> </div>
<div class="line">peryphery = PeripheryUART(<span class="stringliteral">&quot;booster_r&quot;</span>, col_pins, row_pins, board.GP0, board.GP1)</div>
<div class="line"> </div>
<div class="line">mkx_perifery = MKX_Periphery(peryphery, debug=<span class="keyword">True</span>)</div>
<div class="line">mkx_perifery.run_forever()</div>
</div><!-- fragment --><h1><a class="anchor" id="p_4_5"></a>
4.5 Interface</h1>
<p>The <b>Interface</b> connects the <b>Periferies</b> to the <b>MKX_Central</b>. <br  />
</p>
<p>Possible options are <b>InterphaceCentral</b> matching the <b>PeriferyCentral</b> and <br  />
 <b>InterphaceUART</b> matching the <b>PeriferyUART</b>. <br  />
</p>
<p><b>Example:</b> </p><div class="fragment"><div class="line"><span class="keyword">import</span> board</div>
<div class="line"> </div>
<div class="line"><span class="keyword">from</span> mkx.mkx_central <span class="keyword">import</span> MKX_Central</div>
<div class="line"><span class="keyword">from</span> mkx.periphery_central <span class="keyword">import</span> PeripheryCentral</div>
<div class="line"><span class="keyword">from</span> mkx.interphace_central <span class="keyword">import</span> InterphaceCentral</div>
<div class="line"><span class="keyword">from</span> mkx.interphace_uart <span class="keyword">import</span> InterphaceUART</div>
<div class="line"> </div>
<div class="line">mkx_central = MKX_Central()</div>
<div class="line"> </div>
<div class="line">col_pins = (board.GP9, board.GP7, board.GP5, board.GP4, board.GP3, board.GP2)</div>
<div class="line">row_pins = (board.GP10, board.GP11, board.GP13, board.GP15, board.GP17)</div>
<div class="line"> </div>
<div class="line">central_peryphery = PeripheryCentral(<span class="stringliteral">&quot;central_peryphery&quot;</span>, col_pins, row_pins)</div>
<div class="line">mkx_central.add_central_periphery(central_peryphery)</div>
<div class="line"> </div>
<div class="line">interphace_central = InterphaceCentral(central_peryphery, 0, 0, 5, 4)</div>
<div class="line">mkx_central.add_interface(interphace_central)</div>
<div class="line"> </div>
<div class="line">interphace_right = InterphaceUART(<span class="stringliteral">&quot;side_perifery&quot;</span>, <span class="keywordtype">None</span>, board.GP1, 11, 0, 6, 4)</div>
<div class="line">mkx_central.add_interface(interphace_right)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># other code ...</span></div>
<div class="line"> </div>
<div class="line">mkx_central.run_forever()</div>
</div><!-- fragment --><h2><a class="anchor" id="p_4_5_1"></a>
4.5.1 InterphaceCentral</h2>
<p>Set the InterphaceCentral. <br  />
</p>
<p>Min/max column and rows values can be inverted, meaning min value can be bigger than max. <br  />
 Inverted min/max column and rows values will change the keys mapping. <br  />
</p>
<div class="fragment"><div class="line"><span class="keyword">from</span> mkx.interphace_central <span class="keyword">import</span> InterphaceCentral</div>
<div class="line"> </div>
<div class="line">interface = InterphaceCentral(</div>
<div class="line">    central_periphery: InterfahceAbstract, </div>
<div class="line">    col_min :int, </div>
<div class="line">    row_min :int, </div>
<div class="line">    col_max :int, </div>
<div class="line">    row_max :int</div>
<div class="line">)</div>
</div><!-- fragment --><p><b>central_periphery</b> <br  />
 PeriferyCentral object.</p>
<p><b>col_min</b> <br  />
 Minimum column number. Counting start from '0'. <br  />
</p>
<p><b>row_min</b> <br  />
 Minimum row number. Counting start from '0'. <br  />
</p>
<p><b>col_max</b> <br  />
 Maximum column number. Counting start from '0'. <br  />
</p>
<p><b>row_max</b> <br  />
 Maximum row number. Counting start from '0'. <br  />
</p>
<h2><a class="anchor" id="p_4_5_2"></a>
4.5.2 InterphaceUART</h2>
<p>Set the InterphaceUART.</p>
<div class="fragment"><div class="line"><span class="keyword">from</span> mkx.interphace_uart <span class="keyword">import</span> InterphaceUART</div>
<div class="line"> </div>
<div class="line">mkx_perifery = InterphaceUART(</div>
<div class="line">    device_id: str, </div>
<div class="line">    tx_pin,</div>
<div class="line">    rx_pin,</div>
<div class="line">    col_min :int,</div>
<div class="line">    row_min :int,</div>
<div class="line">    col_max :int,</div>
<div class="line">    row_max :int,</div>
<div class="line">    baudrate=9600</div>
<div class="line">)</div>
</div><!-- fragment --><p><b>device_id</b> <br  />
 Device id/name, must match the device_id of the <b>Periphery</b>. <br  />
</p>
<p><b>tx_pin</b> <br  />
 TX communication pin. <br  />
</p>
<p><b>rx_pin</b> <br  />
 RX communication pin. <br  />
</p>
<p><b>col_min</b> <br  />
 Minimum column number. Counting start from '0'. <br  />
</p>
<p><b>row_min</b> <br  />
 Minimum row number. Counting start from '0'. <br  />
</p>
<p><b>col_max</b> <br  />
 Maximum column number. Counting start from '0'. <br  />
</p>
<p><b>row_max</b> <br  />
 Maximum row number. Counting start from '0'. <br  />
</p>
<p><b>baudrate</b> <br  />
 UART communication baudrate. <br  />
</p>
<h1><a class="anchor" id="p_4_6"></a>
4.6 Layer Status LED</h1>
<p>Status LED used for the indication of the active layer. <br  />
</p>
<h2><a class="anchor" id="p_4_6_1"></a>
4.6.1 LayerStatusLedRgbNeoPixel</h2>
<p>RGB NeoPixel LED which indicates active layer by color. <br  />
</p>
<div class="fragment"><div class="line"><span class="keyword">from</span> mkx.layer_status_led_rgb_neopixel <span class="keyword">import</span> LayerStatusLedRgbNeoPixel</div>
<div class="line"> </div>
<div class="line">status_led = LayerStatusLedRgbNeoPixel(</div>
<div class="line">    status_led_pin, </div>
<div class="line">    brightness :float=0.1, </div>
<div class="line">    auto_write :bool=<span class="keyword">True</span></div>
<div class="line">)</div>
</div><!-- fragment --><p><b>status_led_pin</b> <br  />
 Pin for the RGB NeoPixel LED. <br  />
</p>
<p><b>brightness</b> <br  />
 Brightness of the LED in the range 0-1. <br  />
</p>
<p><b>auto_write</b> <br  />
 Flag to update LED color automaticly. <br  />
</p>
<p><b>Example:</b> </p><div class="fragment"><div class="line"><span class="keyword">import</span> board</div>
<div class="line"> </div>
<div class="line"><span class="keyword">from</span> mkx.mkx_central <span class="keyword">import</span> MKX_Central</div>
<div class="line"><span class="keyword">from</span> mkx.layer_status_led_rgb_neopixel <span class="keyword">import</span> LayerStatusLedRgbNeoPixel</div>
<div class="line"> </div>
<div class="line">mkx_central = MKX_Central()</div>
<div class="line"> </div>
<div class="line">status_led = LayerStatusLedRgbNeoPixel(board.GP23, brightness=0.015)</div>
<div class="line">status_led.add_layer(0, (0, 255, 0))  <span class="comment"># Green</span></div>
<div class="line">status_led.add_layer(1, (0, 0, 255))  <span class="comment"># Blue</span></div>
<div class="line"> </div>
<div class="line">mkx_central.add_layer_status_led(status_led)</div>
</div><!-- fragment --><h2><a class="anchor" id="p_4_6_2"></a>
4.6.2 LayerStatusLedRgbThreePin</h2>
<p>RGB three pin LED which indicates active layer by color. <br  />
 <em>Untested!</em> due to lack of proper hardware configuration.</p>
<div class="fragment"><div class="line"><span class="keyword">from</span> mkx.layer_status_led_rgb_threepin <span class="keyword">import</span> LayerStatusLedRgbThreePin</div>
<div class="line"> </div>
<div class="line">status_led = LayerStatusLedRgbThreePin(</div>
<div class="line">    red_pin,</div>
<div class="line">    green_pin,</div>
<div class="line">    blue_pin</div>
<div class="line">)</div>
</div><!-- fragment --><p> <b>red_pin</b> <br  />
 Red LED pin.</p>
<p><b>green_pin</b> <br  />
 Green LED pin.</p>
<p><b>blue_pin</b> <br  />
 Blue LED pin.</p>
<h2><a class="anchor" id="p_4_6_3"></a>
4.6.3 LayerStatusLedArray</h2>
<p>Array of LED which indicates active layer. <br  />
 <em>Untested!</em> due to lack of proper hardware configuration.</p>
<div class="fragment"><div class="line"><span class="keyword">from</span> mkx.layer_status_led_array <span class="keyword">import</span> LayerStatusLedArray</div>
<div class="line"> </div>
<div class="line">status_led = LayerStatusLedArray(</div>
<div class="line">    pins</div>
<div class="line">)</div>
</div><!-- fragment --><p> <b>pins</b> <br  />
 List of pins for LED-s.</p>
<h1><a class="anchor" id="p_4_7"></a>
4.7 Backlight</h1>
<p>RGB NeoPixel backlight.</p>
<h2><a class="anchor" id="p_4_7_1"></a>
4.7.1 BacklightNeopixelStatic</h2>
<p>Static color backlight.</p>
<div class="fragment"><div class="line"><span class="keyword">from</span> mkx.backlight_neopixel_static <span class="keyword">import</span> BacklightNeopixelStatic</div>
<div class="line"> </div>
<div class="line">status_led = BacklightNeopixelStatic(</div>
<div class="line">    pin, </div>
<div class="line">    num_pixels :int, </div>
<div class="line">    rgb_color=(0, 0, 255), </div>
<div class="line">    brightness :float=1</div>
<div class="line">)</div>
</div><!-- fragment --><p><b>pin</b> <br  />
 Pin for the backlight RGB NeoPixel LED-s. <br  />
</p>
<p><b>num_pixels</b> <br  />
 Number of the RGB NeoPixel LED-s. <br  />
</p>
<p><b>rgb_color</b> <br  />
 Peaked values of the RGB color. <br  />
</p>
<p><b>brightness</b> <br  />
 Brightness of the LED in the range 0-1. <br  />
</p>
<p><b>Example:</b> </p><div class="fragment"><div class="line"><span class="keyword">import</span> board</div>
<div class="line"> </div>
<div class="line"><span class="keyword">from</span> mkx.mkx_central <span class="keyword">import</span> MKX_Central</div>
<div class="line"><span class="keyword">from</span> mkx.backlight_neopixel_static <span class="keyword">import</span> BacklightNeopixelStatic</div>
<div class="line"> </div>
<div class="line">mkx_central = MKX_Central()</div>
<div class="line"> </div>
<div class="line">backlight = BacklightNeopixelStatic(board.A0, num_pixels=72, rgb_color=(0, 0, 255), brightness=0.4)</div>
<div class="line"> </div>
<div class="line">mkx_central.add_backlight(backlight)</div>
</div><!-- fragment --><h2><a class="anchor" id="p_4_7_2"></a>
4.7.2 BacklightNeopixelRainbow</h2>
<p>Rainbow animated color backlight.</p>
<div class="fragment"><div class="line"><span class="keyword">from</span> mkx.backlight_neopixel_rainbow <span class="keyword">import</span> BacklightNeopixelRainbow</div>
<div class="line"> </div>
<div class="line">status_led = BacklightNeopixelRainbow(</div>
<div class="line">    pin, </div>
<div class="line">    num_pixels :int, </div>
<div class="line">    rgb_color=(0, 0, 255), </div>
<div class="line">    brightness :float=1</div>
<div class="line">)</div>
</div><!-- fragment --><p><b>pin</b> <br  />
 Pin for the backlight RGB NeoPixel LED-s. <br  />
</p>
<p><b>num_pixels</b> <br  />
 Number of the RGB NeoPixel LED-s. <br  />
</p>
<p><b>brightness</b> <br  />
 Brightness of the LED in the range 0-1. <br  />
</p>
<h2><a class="anchor" id="p_4_7_2_1"></a>
4.7.2.1 faster()</h2>
<p>Hom much faster should be the rainbow animation from the initial one.</p>
<div class="fragment"><div class="line">backlight.faster(</div>
<div class="line">    value</div>
<div class="line">)</div>
</div><!-- fragment --><p><b>value</b> <br  />
 Increased animation speed up to 20.</p>
<h2><a class="anchor" id="p_4_7_2_2"></a>
4.7.2.2 slower()</h2>
<p>Hom much slower should be the rainbow animation from the initial one.</p>
<div class="fragment"><div class="line">backlight.slower(</div>
<div class="line">    value</div>
<div class="line">)</div>
</div><!-- fragment --><p><b>value</b> <br  />
 Decreased animation speed up to 20.</p>
<h2><a class="anchor" id="p_4_7_2_3"></a>
4.7.2.3 set_swirl()</h2>
<p>Should the LED-s change color independently by swirl or not.</p>
<div class="fragment"><div class="line">backlight.set_swirl(</div>
<div class="line">    swirl :bool</div>
<div class="line">)</div>
</div><!-- fragment --><p><b>swirl</b> <br  />
 Swirl or not.</p>
<p><b>Example:</b> </p><div class="fragment"><div class="line"><span class="keyword">import</span> board</div>
<div class="line"> </div>
<div class="line"><span class="keyword">from</span> mkx.mkx_central <span class="keyword">import</span> MKX_Central</div>
<div class="line"><span class="keyword">from</span> mkx.backlight_neopixel_rainbow <span class="keyword">import</span> BacklightNeopixelRainbow</div>
<div class="line"> </div>
<div class="line">mkx_central = MKX_Central()</div>
<div class="line"> </div>
<div class="line">backlight = BacklightNeopixelRainbow(board.A0, num_pixels=72, brightness=0.4)</div>
<div class="line">backlight.slower(2)</div>
<div class="line">backlight.set_swirl(<span class="keyword">True</span>)</div>
<div class="line"> </div>
<div class="line">mkx_central.add_backlight(backlight)</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
